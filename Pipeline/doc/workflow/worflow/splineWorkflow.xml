<workflow name="spline">
  <params>
    <param name="queryExtDbRlsSpec"/>
    <param name="subjectExtDbRlsSpec"/>
    <param name="genomeName"/>
  </params>

  <constants>
    <constant name="querySeqType">tc</constant>
    <constant name="subjectSeqType">genome</constant>
    <constant name="table">ExternalNaSequence</constant>
  </constants>


  <steps>
    <step name="extractQuery" class="ApiCommonData::Steps::FastaExtractor">
      <configValue name="extDbRlsSpec">$$$queryExtDbRlsSpec</configValue>
      <configValue name="genomeName">$$$genomeName</configValue>
      <configValue name="seqType">@@@querySeqType</configValue>
      <configValue name="table">@@@table</configValue>
      <configValue name="defline">'lcl|'||source_id'</configValue>
    </step>

    <step name="extractSubject" class="ApiCommonData::Steps::FastaExtractor">
      <configValue name="extDbRlsSpec">$$$subjectExtDbRlsSpec</configValue>
      <configValue name="genomeName">$$$genomeName</configValue>
      <configValue name="seqType">@@@subjectSeqType</configValue>
      <configValue name="table">@@@table</configValue>
      <configValue name="defline">'lcl|'||source_id'</configValue>
    </step>

    <step name="runSplign" class="ApiCommonData::Steps::RunSplign">
      <configValue name="genomeName">$$$genomeName</configValue>
      <configValue name="querySeqType">@@@querySeqType</configValue>
      <configValue name="subjectSeqType">@@@subjectSeqType</configValue>
      <depends step="extractQuery"/>
      <depends step="extractSubject"/>
    </step>

    <step name="insertSplign" class="ApiCommonData::Steps::InsertSplign">
      <configValue name="genomeName">$$$genomeName</configValue>
      <configValue name="querySeqType">@@@querySeqType</configValue>
      <configValue name="subjectSeqType">@@@subjectSeqType</configValue>
      <configValue name="queryExtDbRlsSpec">$$$queryExtDbRlsSpec</configValue>
      <configValue name="subjectExtDbRlsSpec">$$$subjectExtDbRlsSpec</configValue>
      <configValue name="queryTable">@@@table</configValue>
      <configValue name="subjectTable">@@@table</configValue>
      <depends step="runSplign"/>
    </step>

  </steps
