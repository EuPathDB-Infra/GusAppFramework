#!@perl@

use strict;
use lib "$ENV{GUS_HOME}/lib/perl";

if (scalar(@ARGV) != 1) {
  die
"
Report the features and qualifiers used in an embl file

Usage: findEmblFeatureQualifers emblFile

";
}

open(FILE, $ARGV[0]) || die "Couldn't open embl file '$ARGV[0]' for reading\n";

my $currentFeature;
my $features = {};
while (<FILE>) {
  next unless /^FT/;
  if (/^FT   (\w+)  /) {
    $currentFeature = $1;
    if (!$features->{$currentFeature}) {
      $features->{$currentFeature} = {};
    }
  } elsif (/^FT\s+\/(\w+)[=|\s]/) {
    $features->{$currentFeature}->{$1} = 1;
  }
}

foreach my $feature (sort(keys %{$features})) {
  print "$feature\n";
  foreach my $qualifer (sort(keys %{$features->{$feature}})) {
    print "  $qualifer\n";
  }
  print "\n";
}
