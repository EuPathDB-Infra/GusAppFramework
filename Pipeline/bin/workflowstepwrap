#!/usr/bin/perl

use DBI;
use GUS::Pipeline::Workflow;

my $stepName = $ARGV[0];
my $stepClass = $ARGV[1];
my $metaConfigFile = $ARGV[2];
my $workflowId = $ARGV[3];

if (scalar($ARGV) != 4) {
    usage();
}

# get step config
# get dbhandle

my $step = eval "{require $stepClass;$stepClass->new($stepName, $metaConfigFile, $workflowId)}";

my $status = $step->runInWrapper($workflowId, $stepName);

exit($status);


sub usage {
    print "
Caution!! this program is only called by the workflow controller

usage: workflowstep stepname stepclass metaconfigfile workflow_id
";
    exit(1);
}




